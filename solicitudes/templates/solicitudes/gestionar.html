{% extends 'base.html' %}

{% block title %}Gestionar Solicitudes{% endblock %}

{% block content %}
<h1>Gestionar Solicitudes de Adopción</h1>

<table class="datatable">
    <thead>
        <tr>
            <th>Usuario</th>
            <th>Mascota</th>
            <th>Fecha Solicitud</th>
            <th>Estado</th>
            <th>Observaciones</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for solicitud in solicitudes %}
            <tr>
                <td>{{ solicitud.usuario.get_full_name }} ({{ solicitud.usuario.username }})</td>
                <td>
                    <a href="{% url 'mascotas:detalle' solicitud.mascota.id %}">
                        {{ solicitud.mascota.nombre }}
                    </a>
                </td>
                <td>{{ solicitud.fecha_solicitud|date:"d/m/Y H:i" }}</td>
                <td>{{ solicitud.get_estado_display }}</td>
                <td>{{ solicitud.observaciones|default:"Sin observaciones" }}</td>
                <td>
                    {% if solicitud.estado == 'pendiente' %}
                        <a href="{% url 'solicitudes:procesar' solicitud.id 'aprobar' %}" 
                           onclick="return confirm('¿Aprobar esta solicitud? Esto adoptará la mascota y rechazará las demás solicitudes.')">
                           Aprobar
                        </a>
                        <a href="{% url 'solicitudes:procesar' solicitud.id 'rechazar' %}" 
                           onclick="return confirm('¿Rechazar esta solicitud?')">
                           Rechazar
                        </a>
                    {% else %}
                        -
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
